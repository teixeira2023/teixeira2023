<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SOS Crash Alert Simulator</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #1e3c72, #2a5298);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            color: white;
        }

        .container {
            background: rgba(0, 0, 0, 0.8);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.5);
            max-width: 900px;
            width: 100%;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            color: #ff6b6b;
            text-shadow: 0 0 10px rgba(255, 107, 107, 0.5);
        }

        .status-panel {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .status-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            border: 2px solid transparent;
            transition: all 0.3s ease;
        }

        .status-card.active {
            border-color: #ff6b6b;
            box-shadow: 0 0 20px rgba(255, 107, 107, 0.3);
        }

        .status-card h3 {
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .status-indicator {
            font-size: 2em;
            font-weight: bold;
            padding: 10px;
            border-radius: 10px;
            margin: 10px 0;
        }

        .status-normal {
            background: #4CAF50;
            color: white;
        }

        .status-activated {
            background: #ff6b6b;
            color: white;
            animation: pulse 1s infinite;
        }

        .timer {
            font-size: 3em;
            font-weight: bold;
            text-align: center;
            margin: 20px 0;
            font-family: 'Courier New', monospace;
        }

        .controls {
            text-align: center;
            margin-bottom: 30px;
        }

        .config-section {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            border: 2px solid rgba(255, 255, 255, 0.2);
        }

        .config-section h4 {
            margin-bottom: 15px;
            color: #ffd700;
            font-size: 1.2em;
        }

        .config-options {
            display: flex;
            justify-content: center;
            gap: 30px;
            flex-wrap: wrap;
        }

        .config-option {
            display: flex;
            align-items: center;
            cursor: pointer;
            padding: 10px 15px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            border: 2px solid transparent;
            transition: all 0.3s ease;
        }

        .config-option:hover {
            background: rgba(255, 255, 255, 0.2);
            border-color: #ffd700;
        }

        .config-option input[type="radio"] {
            display: none;
        }

        .radio-custom {
            width: 20px;
            height: 20px;
            border: 2px solid #666;
            border-radius: 50%;
            margin-right: 10px;
            position: relative;
            transition: all 0.3s ease;
        }

        .config-option input[type="radio"]:checked+.radio-custom {
            border-color: #ffd700;
            background: #ffd700;
        }

        .config-option input[type="radio"]:checked+.radio-custom::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 8px;
            height: 8px;
            background: #333;
            border-radius: 50%;
        }

        .action-buttons {
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
        }

        .btn {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 1.2em;
            border-radius: 10px;
            cursor: pointer;
            margin: 0 10px;
            transition: all 0.3s ease;
        }

        .btn:hover {
            background: #45a049;
            transform: translateY(-2px);
        }

        .btn.danger {
            background: #ff6b6b;
        }

        .btn.danger:hover {
            background: #ff5252;
        }

        .btn.inhibited {
            background: #666 !important;
            color: #999 !important;
            cursor: not-allowed !important;
            opacity: 0.6;
        }

        .btn.inhibited:hover {
            background: #666 !important;
            transform: none !important;
        }

        .vehicle-lights {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }

        .light-section {
            text-align: center;
        }

        .light-section h4 {
            margin-bottom: 15px;
            color: #ffd700;
        }

        .light {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            margin: 5px;
            display: inline-block;
            background: #333;
            border: 2px solid #666;
            transition: all 0.3s ease;
        }

        .light.blinking {
            background: #ffd700;
            box-shadow: 0 0 20px #ffd700;
            animation: blink 1s infinite;
        }

        .light.internal {
            background: #333;
            border-color: #666;
        }

        .light.internal.on {
            background: #ffd700;
            box-shadow: 0 0 20px #ffd700;
        }

        .doors {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin-bottom: 30px;
        }

        .door {
            text-align: center;
            padding: 15px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            border: 2px solid #666;
            transition: all 0.3s ease;
        }

        .door.unlocked {
            border-color: #4CAF50;
            background: rgba(76, 175, 80, 0.2);
        }

        .door.inhibited {
            border-color: #ff9800;
            background: rgba(255, 152, 0, 0.2);
            position: relative;
        }

        .door.inhibited::after {
            content: 'üîí INIBIDO';
            position: absolute;
            top: -10px;
            left: 50%;
            transform: translateX(-50%);
            background: #ff9800;
            color: white;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 0.8em;
            font-weight: bold;
            white-space: nowrap;
        }

        .door h4 {
            margin-bottom: 10px;
            font-size: 1em;
            line-height: 1.3;
        }

        .door h4 small {
            display: block;
            margin-top: 5px;
            font-weight: normal;
            opacity: 0.9;
        }

        .door-status {
            font-size: 1.2em;
            font-weight: bold;
        }

        .door-locked {
            color: #ff6b6b;
        }

        .door-unlocked {
            color: #4CAF50;
        }

        @keyframes blink {

            0%,
            50% {
                opacity: 1;
            }

            51%,
            100% {
                opacity: 0.3;
            }
        }

        @keyframes pulse {
            0% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.05);
            }

            100% {
                transform: scale(1);
            }
        }

        .log {
            background: rgba(0, 0, 0, 0.5);
            border-radius: 10px;
            padding: 20px;
            max-height: 200px;
            overflow-y: auto;
        }

        .log-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .log h4 {
            margin: 0;
            color: #ffd700;
        }

        .btn-small {
            padding: 8px 16px;
            font-size: 0.9em;
            margin: 0;
        }

        .log-entry {
            padding: 5px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }

        .log-time {
            color: #ffd700;
        }

        .log-event {
            color: #fff;
        }

        @media (max-width: 768px) {
            .container {
                margin: 20px;
                padding: 20px;
            }

            .status-panel {
                grid-template-columns: 1fr;
                gap: 20px;
            }

            .vehicle-lights {
                grid-template-columns: 1fr;
            }

            .doors {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="header">
            <h1>üöó SOS Crash Alert Simulator</h1>
            <p>Sistema de Alerta de Colis√£o com Resposta Autom√°tica de Emerg√™ncia</p>
        </div>

        <div class="status-panel">
            <div class="status-card" id="systemStatus">
                <h3>Status do Sistema</h3>
                <div class="status-indicator status-normal" id="statusIndicator">NORMAL</div>
                <p>Estado atual do sistema SOS</p>
            </div>

            <div class="status-card" id="timerCard">
                <h3>Timer de Emerg√™ncia</h3>
                <div class="timer" id="emergencyTimer">00:00</div>
                <p>Tempo decorrido desde a ativa√ß√£o</p>
            </div>
        </div>

        <div class="controls">
            <div class="config-section">
                <h4>‚öôÔ∏è Configura√ß√£o das Portas</h4>
                <div class="config-options">
                    <label class="config-option">
                        <input type="radio" name="doorConfig" value="immediate" checked>
                        <span class="radio-custom"></span>
                        Imediato (destrava instantaneamente)
                    </label>
                    <label class="config-option">
                        <input type="radio" name="doorConfig" value="delayed">
                        <span class="radio-custom"></span>
                        Delayed (inibido por 6s, travado por 10s)
                    </label>
                </div>
            </div>
            <div class="action-buttons">
                <button class="btn danger" id="crashBtn">üö® SIMULAR ACIDENTE</button>
                <button class="btn" id="hazardSwitchBtn">‚ö†Ô∏è HAZARD SWITCH</button>
                <button class="btn" id="keyfobPanicBtn">üîë KEYFOB PANIC</button>
                <button class="btn" id="keyfobUnlockBtn">üîì KEYFOB UNLOCK</button>
            </div>
        </div>

        <div class="vehicle-lights">
            <div class="light-section">
                <h4>üîÑ Setas Dianteiras</h4>
                <div class="light" id="frontLeft"></div>
                <div class="light" id="frontRight"></div>
            </div>

            <div class="light-section">
                <h4>üîÑ Setas Traseiras</h4>
                <div class="light" id="rearLeft"></div>
                <div class="light" id="rearRight"></div>
            </div>

            <div class="light-section">
                <h4>ü™û Espelhos Retrovisores</h4>
                <div class="light" id="mirrorLeft"></div>
                <div class="light" id="mirrorRight"></div>
            </div>
        </div>

        <div class="doors">
            <div class="door" id="doorFrontLeft">
                <h4>Porta Dianteira Esquerda</h4>
                <div class="door-status door-locked">TRAVADA</div>
            </div>

            <div class="door" id="doorFrontRight">
                <h4>Porta Dianteira Direita</h4>
                <div class="door-status door-locked">TRAVADA</div>
            </div>

            <div class="door" id="doorRearLeft">
                <h4>Porta Traseira Esquerda</h4>
                <div class="door-status door-locked">TRAVADA</div>
            </div>

            <div class="door" id="doorRearRight">
                <h4>Porta Traseira Direita</h4>
                <div class="door-status door-locked">TRAVADA</div>
            </div>
        </div>

        <div class="light-section">
            <h4>üí° Ilumina√ß√£o Interna</h4>
            <div class="light internal" id="internalLight1"></div>
            <div class="light internal" id="internalLight2"></div>
            <div class="light internal" id="internalLight3"></div>
            <div class="light internal" id="internalLight4"></div>
        </div>

        <div class="log">
            <div class="log-header">
                <h4>üìã Log de Eventos</h4>
                <button class="btn btn-small" id="saveLogBtn">üíæ Salvar Log</button>
            </div>
            <div id="logContainer"></div>
        </div>
    </div>

    <script>
        class SOSCrashAlert {
            constructor() {
                this.isActivated = false;
                this.timer = 0;
                this.timerInterval = null;
                this.lightInterval = null;
                this.internalLightTimer = null;
                this.doorUnlockTimer = null;
                this.doorConfig = 'immediate';
                this.doorsInhibited = false;

                this.initializeElements();
                this.bindEvents();
                this.addLogEntry('Sistema inicializado', 'normal');
            }

            initializeElements() {
                this.elements = {
                    statusIndicator: document.getElementById('statusIndicator'),
                    emergencyTimer: document.getElementById('emergencyTimer'),
                    crashBtn: document.getElementById('crashBtn'),
                    hazardSwitchBtn: document.getElementById('hazardSwitchBtn'),
                    keyfobPanicBtn: document.getElementById('keyfobPanicBtn'),
                    keyfobUnlockBtn: document.getElementById('keyfobUnlockBtn'),
                    saveLogBtn: document.getElementById('saveLogBtn'),
                    systemStatus: document.getElementById('systemStatus'),
                    timerCard: document.getElementById('timerCard'),
                    lights: {
                        frontLeft: document.getElementById('frontLeft'),
                        frontRight: document.getElementById('frontRight'),
                        rearLeft: document.getElementById('rearLeft'),
                        rearRight: document.getElementById('rearRight'),
                        mirrorLeft: document.getElementById('mirrorLeft'),
                        mirrorRight: document.getElementById('mirrorRight')
                    },
                    doors: {
                        frontLeft: document.getElementById('doorFrontLeft'),
                        frontRight: document.getElementById('doorFrontRight'),
                        rearLeft: document.getElementById('doorRearLeft'),
                        rearRight: document.getElementById('doorRearRight')
                    },
                    internalLights: [
                        document.getElementById('internalLight1'),
                        document.getElementById('internalLight2'),
                        document.getElementById('internalLight3'),
                        document.getElementById('internalLight4')
                    ]
                };
            }

            bindEvents() {
                this.elements.crashBtn.addEventListener('click', () => this.activateSOS());
                this.elements.hazardSwitchBtn.addEventListener('click', () => {
                    if (this.elements.hazardSwitchBtn.classList.contains('inhibited')) {
                        this.addLogEntry('Tentativa de reset via Hazard Switch BLOQUEADA - sistema inibido por 10 segundos', 'warning');
                        return;
                    }
                    this.resetSystem('Hazard Switch');
                });
                this.elements.keyfobPanicBtn.addEventListener('click', () => {
                    if (this.elements.keyfobPanicBtn.classList.contains('inhibited')) {
                        this.addLogEntry('Tentativa de reset via Keyfob Panic BLOQUEADA - sistema inibido por 10 segundos', 'warning');
                        return;
                    }
                    this.resetSystem('Keyfob Panic');
                });
                this.elements.keyfobUnlockBtn.addEventListener('click', () => this.attemptDoorUnlock());
                this.elements.saveLogBtn.addEventListener('click', () => this.saveLogToFile());

                // Configura√ß√£o das portas
                const doorConfigRadios = document.querySelectorAll('input[name="doorConfig"]');
                doorConfigRadios.forEach(radio => {
                    radio.addEventListener('change', (e) => {
                        this.doorConfig = e.target.value;
                        this.addLogEntry(`Configura√ß√£o das portas alterada para: ${this.doorConfig === 'immediate' ? 'Imediato' : 'Delayed'}`, 'config');
                    });
                });
            }

            activateSOS() {
                if (this.isActivated) return;

                this.isActivated = true;
                this.timer = 0;

                // Atualizar status
                this.elements.statusIndicator.textContent = 'ATIVADO';
                this.elements.statusIndicator.className = 'status-indicator status-activated';
                this.elements.systemStatus.classList.add('active');
                this.elements.timerCard.classList.add('active');

                // Iniciar timer
                this.startTimer();

                // Ativar setas (piscando a cada 1s)
                this.startLightBlinking();

                // Destravar portas conforme configura√ß√£o
                if (this.doorConfig === 'immediate') {
                    this.unlockAllDoors();
                    this.addLogEntry('Portas destravadas imediatamente', 'info');
                } else {
                    this.inhibitDoors();
                    this.scheduleDoorUnlock();
                    this.addLogEntry('Portas inibidas por 6 segundos', 'warning');
                }

                // Timer para ilumina√ß√£o interna (10s)
                this.scheduleInternalLights();

                // Inibir bot√µes de reset por 10 segundos
                this.inhibitResetButtons();

                this.addLogEntry('SOS Crash Alert ATIVADO!', 'emergency');
                this.addLogEntry('Setas piscando', 'info');
            }

            startTimer() {
                this.timerInterval = setInterval(() => {
                    this.timer++;
                    this.updateTimerDisplay();
                }, 1000);
            }

            updateTimerDisplay() {
                const minutes = Math.floor(this.timer / 60);
                const seconds = this.timer % 60;
                this.elements.emergencyTimer.textContent =
                    `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            }

            startLightBlinking() {
                this.lightInterval = setInterval(() => {
                    // Alternar estado das luzes
                    const isOn = (this.timer % 2) === 0;

                    Object.values(this.elements.lights).forEach(light => {
                        if (isOn) {
                            light.classList.add('blinking');
                        } else {
                            light.classList.remove('blinking');
                        }
                    });
                }, 500); // Mudan√ßa a cada 500ms para piscar a cada 1s
            }

            unlockAllDoors() {
                Object.values(this.elements.doors).forEach(door => {
                    door.classList.remove('inhibited');
                    door.classList.add('unlocked');
                    const statusElement = door.querySelector('.door-status');
                    statusElement.textContent = 'DESTRAVADA';
                    statusElement.className = 'door-status door-unlocked';

                    // Remover descri√ß√£o de tempo
                    const doorTitle = door.querySelector('h4');
                    if (doorTitle.innerHTML.includes('<br><small')) {
                        doorTitle.innerHTML = doorTitle.textContent;
                    }
                });
                this.doorsInhibited = false;

                // Remover inibi√ß√£o do bot√£o de destravamento
                this.elements.keyfobUnlockBtn.classList.remove('inhibited');
                this.elements.keyfobUnlockBtn.title = '';
            }

            inhibitDoors() {
                Object.values(this.elements.doors).forEach(door => {
                    door.classList.add('inhibited');
                    const statusElement = door.querySelector('.door-status');
                    statusElement.textContent = 'INIBIDO';
                    statusElement.className = 'door-status door-locked';

                    // Adicionar descri√ß√£o com informa√ß√µes de tempo
                    const doorTitle = door.querySelector('h4');
                    if (this.doorConfig === 'delayed') {
                        doorTitle.innerHTML = `${doorTitle.textContent}<br><small style="color: #ffd700; font-size: 0.8em;">üîí Inibido por 6s | üîì Destrava em 10s</small>`;
                    }
                });
                this.doorsInhibited = true;

                // Inibir o bot√£o de destravamento
                this.elements.keyfobUnlockBtn.classList.add('inhibited');
                this.elements.keyfobUnlockBtn.title = 'Portas inibidas - aguarde 6 segundos';
            }

            scheduleDoorUnlock() {
                this.doorUnlockTimer = setTimeout(() => {
                    // Ap√≥s 6 segundos, remover inibi√ß√£o mas manter travadas por mais 4 segundos
                    this.removeDoorInhibition();
                    this.addLogEntry('Inibi√ß√£o das portas removida ap√≥s 6 segundos', 'info');

                    // Agendar destravamento total ap√≥s 10 segundos
                    setTimeout(() => {
                        this.unlockAllDoors();
                        this.addLogEntry('Portas destravadas ap√≥s per√≠odo total de 10 segundos', 'info');
                    }, 4000); // 4 segundos adicionais (6s + 4s = 10s total)
                }, 6000); // 6 segundos
            }

            removeDoorInhibition() {
                Object.values(this.elements.doors).forEach(door => {
                    door.classList.remove('inhibited');
                    const statusElement = door.querySelector('.door-status');
                    statusElement.textContent = 'TRAVADA';
                    statusElement.className = 'door-status door-locked';

                    // Atualizar descri√ß√£o para mostrar que ainda est√° travada
                    const doorTitle = door.querySelector('h4');
                    if (this.doorConfig === 'delayed') {
                        doorTitle.innerHTML = `${doorTitle.textContent.split('<br>')[0]}<br><small style="color: #ffd700; font-size: 0.8em;">üîì Destrava em 4s</small>`;
                    }
                });
                this.doorsInhibited = false;

                // Remover inibi√ß√£o do bot√£o de destravamento
                this.elements.keyfobUnlockBtn.classList.remove('inhibited');
                this.elements.keyfobUnlockBtn.title = '';
            }


            attemptDoorUnlock() {
                if (this.doorsInhibited) {
                    this.addLogEntry('Tentativa de reset via keyfob BLOQUEADA - portas inibidas', 'warning');
                    return;
                }

                if (!this.isActivated) {
                    this.addLogEntry('Tentativa de reset via keyfob - sistema n√£o ativado', 'info');
                    return;
                }

                // Verificar se o bot√£o ainda est√° inibido (primeiros 10 segundos)
                if (this.elements.keyfobUnlockBtn.classList.contains('inhibited')) {
                    this.addLogEntry('Tentativa de reset via keyfob BLOQUEADA - sistema inibido por 10 segundos', 'warning');
                    return;
                }

                // Se o sistema est√° ativado e as portas n√£o est√£o inibidas, resetar o sistema
                this.addLogEntry('Sistema resetado via Keyfob Unlock', 'info');
                this.resetSystem('Keyfob Unlock');
            }

            scheduleInternalLights() {
                this.internalLightTimer = setTimeout(() => {
                    this.activateInternalLights();
                }, 10000); // 10 segundos
            }

            activateInternalLights() {
                this.elements.internalLights.forEach(light => {
                    light.classList.add('on');
                });
                this.addLogEntry('Ilumina√ß√£o interna ativada (10s)', 'info');
            }

            resetSystem(source = 'Manual') {
                this.isActivated = false;
                this.timer = 0;

                // Limpar timers
                if (this.timerInterval) clearInterval(this.timerInterval);
                if (this.lightInterval) clearInterval(this.lightInterval);
                if (this.internalLightTimer) clearTimeout(this.internalLightTimer);
                if (this.doorUnlockTimer) clearTimeout(this.doorUnlockTimer);

                // Resetar status
                this.elements.statusIndicator.textContent = 'NORMAL';
                this.elements.statusIndicator.className = 'status-indicator status-normal';
                this.elements.systemStatus.classList.remove('active');
                this.elements.timerCard.classList.remove('active');
                this.elements.emergencyTimer.textContent = '00:00';

                // Resetar luzes
                Object.values(this.elements.lights).forEach(light => {
                    light.classList.remove('blinking');
                });

                // Resetar ilumina√ß√£o interna
                this.elements.internalLights.forEach(light => {
                    light.classList.remove('on');
                });

                // Resetar portas
                Object.values(this.elements.doors).forEach(door => {
                    door.classList.remove('unlocked', 'inhibited');
                    const statusElement = door.querySelector('.door-status');
                    statusElement.textContent = 'TRAVADA';
                    statusElement.className = 'door-status door-locked';

                    // Remover descri√ß√£o de tempo
                    const doorTitle = door.querySelector('h4');
                    if (doorTitle.innerHTML.includes('<br><small')) {
                        doorTitle.innerHTML = doorTitle.textContent;
                    }
                });
                this.doorsInhibited = false;

                // Remover inibi√ß√£o do bot√£o de destravamento
                this.elements.keyfobUnlockBtn.classList.remove('inhibited');
                this.elements.keyfobUnlockBtn.title = '';

                // Remover inibi√ß√£o dos outros bot√µes de reset
                this.elements.hazardSwitchBtn.classList.remove('inhibited');
                this.elements.hazardSwitchBtn.title = '';
                this.elements.keyfobPanicBtn.classList.remove('inhibited');
                this.elements.keyfobPanicBtn.title = '';

                this.addLogEntry(`Sistema resetado via ${source}`, 'normal');
            }

            addLogEntry(message, type) {
                const logContainer = document.getElementById('logContainer');
                const timestamp = new Date().toLocaleTimeString();

                const logEntry = document.createElement('div');
                logEntry.className = 'log-entry';
                logEntry.innerHTML = `
                    <span class="log-time">[${timestamp}]</span>
                    <span class="log-event">${message}</span>
                `;

                logContainer.appendChild(logEntry);
                logContainer.scrollTop = logContainer.scrollHeight;
            }

            saveLogToFile() {
                const logContainer = document.getElementById('logContainer');
                const logEntries = logContainer.querySelectorAll('.log-entry');

                if (logEntries.length === 0) {
                    this.addLogEntry('Nenhum evento para salvar', 'warning');
                    return;
                }

                // Criar conte√∫do do arquivo
                let fileContent = '=== SOS CRASH ALERT SIMULATOR - LOG DE EVENTOS ===\n';
                fileContent += `Data/Hora: ${new Date().toLocaleString('pt-BR')}\n`;
                fileContent += '================================================\n\n';

                logEntries.forEach(entry => {
                    const time = entry.querySelector('.log-time').textContent;
                    const event = entry.querySelector('.log-event').textContent;
                    fileContent += `${time} ${event}\n`;
                });

                // Criar blob e download
                const blob = new Blob([fileContent], { type: 'text/plain;charset=utf-8' });
                const url = URL.createObjectURL(blob);

                const a = document.createElement('a');
                a.href = url;
                a.download = `sos_crash_alert_log_${new Date().toISOString().slice(0, 19).replace(/:/g, '-')}.txt`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);

                URL.revokeObjectURL(url);

                this.addLogEntry('Log salvo com sucesso em arquivo TXT', 'info');
            }

            inhibitResetButtons() {
                this.elements.hazardSwitchBtn.classList.add('inhibited');
                this.elements.hazardSwitchBtn.title = 'Sistema inibido - aguarde 10 segundos';
                this.elements.keyfobPanicBtn.classList.add('inhibited');
                this.elements.keyfobPanicBtn.title = 'Sistema inibido - aguarde 10 segundos';
                this.elements.keyfobUnlockBtn.classList.add('inhibited');
                this.elements.keyfobUnlockBtn.title = 'Sistema inibido - aguarde 10 segundos';

                // Remover inibi√ß√£o ap√≥s 10 segundos
                setTimeout(() => {
                    this.enableResetButtons();
                }, 10000);
            }

            enableResetButtons() {
                this.elements.hazardSwitchBtn.classList.remove('inhibited');
                this.elements.hazardSwitchBtn.title = '';
                this.elements.keyfobPanicBtn.classList.remove('inhibited');
                this.elements.keyfobPanicBtn.title = '';

                // Para o keyfob unlock, verificar se as portas ainda est√£o inibidas
                if (!this.doorsInhibited) {
                    this.elements.keyfobUnlockBtn.classList.remove('inhibited');
                    this.elements.keyfobUnlockBtn.title = '';
                }

                this.addLogEntry('Bot√µes de reset habilitados ap√≥s 10 segundos', 'info');
            }
        }

        // Inicializar o sistema quando a p√°gina carregar
        document.addEventListener('DOMContentLoaded', () => {
            new SOSCrashAlert();
        });
    </script>
</body>

</html>